CMD: setlocal

Начало локализации изменений среды в пакетном файле. Изменения среды,
внесенные после выполнения команды SETLOCAL, являются локальными
относительно текущего пакетного файла. Для восстановления их прежних
значений необходимо выполнить команду ENDLOCAL. При достижении
конца пакетного файла автоматически выполняется команда ENDLOCAL для
всех действующих команд SETLOCAL, выполненных в этом пакетном файле.

SETLOCAL

Изменение команды SETLOCAL при включении расширенной обработки команд:

Пакетная команда SETLOCAL принимает необязательные аргументы:
        ENABLEEXTENSIONS / DISABLEEXTENSIONS
            Это позволяет включить или отключить расширенную обработку команд.
            Эти аргументы переопределяют параметры CMD /E:ON или /E:OFF. Для
            получения дополнительных сведений введите CMD /?.
        ENABLEDELAYEDEXPANSION / DISABLEDELAYEDEXPANSION
            Это позволяет включить или отключить отложенное расширение переменных среды. Эти
            аргументы переопределяют параметры CMD /V:ON или /V:OFF. Для
            получения дополнительных сведений введите CMD /?.
Эти изменения действуют до выполнения соответствующей команды ENDLOCAL,
независимо от их настройки до команды SETLOCAL.

Если команда SETLOCAL вызывается с аргументом, она  устанавливает значение
ERRORLEVEL.  Если указан один из двух допустимых аргументов, это значение будет
равно нулю, в противном случае возвращается единица.  Эту команду можно
использовать в пакетных сценариях, чтобы определить доступность расширенной
обработки команд, следующим образом:

    VERIFY OTHER 2>nul
    SETLOCAL ENABLEEXTENSIONS
    IF ERRORLEVEL 1 echo Не удается включить расширенную обработку

Эта последовательность команд работает, так как в прежних версиях CMD.EXE
команда SETLOCAL НЕ устанавливала значение ERRORLEVEL. Команда VERIFY с
недопустимым аргументом необходима для установки ненулевого значения
ERRORLEVEL.
